PROJECT(MILKY)

FIND_PACKAGE(CURL REQUIRED)
FIND_PACKAGE(OpenSSL REQUIRED)

SET(milky_SOURCES
    src/lib/md5.c
    src/lib/pnd.c
    src/lib/alpm_list.c
    src/lib/parseconfig.c
    src/lib/file.c
    src/lib/download.c
    src/lib/upgrade.c
    src/lib/json.c
    src/lib/install.c
    src/lib/dev.c
    src/lib/milky.c
    src/lib/remove.c
    src/lib/sync.c
    src/lib/curl.c
    src/lib/logfile.c
    src/lib/crawl.c
    src/lib/conf.c)

SET(milky_HEADERS
    src/lib/json.h
    src/lib/parseconfig.h
    src/lib/conf.h
    src/lib/crawl.h
    src/lib/milky.h
    src/lib/curl.h
    src/lib/alpm_list.h
    src/lib/install.h
    src/lib/pnd_container.h
    src/lib/download.h
    src/lib/event.h
    src/lib/dev.h
    src/lib/version.h
    src/lib/remove.h
    src/lib/logfile.h
    src/lib/sync.h
    src/lib/pnd.h
    src/lib/upgrade.h
    src/lib/md5.h
    src/lib/pnd_discovery.h
    src/lib/file.h)

SET(milky_INCLUDES src/include/milky/milky.h src/lib/alpm_list.h)

INCLUDE_DIRECTORIES(src/lib/ ${OpenSSL_INCLUDE_DIR} ${CURL_INCLUDE_DIR})
INCLUDE_DIRECTORIES(${JANSSON_BINARY_DIR}/include/)
INCLUDE_DIRECTORIES(${PND_BINARY_DIR}/include/)
LINK_DIRECTORIES(${CURL_LIBRARY_DIRS} ${OpenSSL_LIBRARY_DIRS})
FILE(COPY ${milky_INCLUDES} DESTINATION include/milky/)
ADD_DEFINITIONS(-fPIC)
ADD_LIBRARY(milky ${milky_SOURCES} ${milky_HEADERS})
TARGET_LINK_LIBRARIES(milky m curl ssl jansson stdc++ pnd)

